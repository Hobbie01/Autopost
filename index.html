<!doctype html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ส่งรูป + Content + Prompt ไปยัง Webhook</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>ส่งรูป, Content และ Prompt ไปยัง Webhook</h1>
          <p class="desc">ระบบจะส่งข้อมูลแบบ <code>multipart/form-data</code> ไปยังปลายทางที่กำหนด</p>
        </div>
      </div>

      <form id="sendForm" action="https://n8n.xn--12cmi3bhufp3kwcifc4hsgtdec.com/webhook/bcde588a-f3b9-48bd-a3dd-4cfef99d7239" method="post" enctype="multipart/form-data">
        <div class="field" style="grid-column: 1 / -1;">
          <label for="image">รูปภาพ (field name: <code>image</code>)</label>
          <div class="uploader">
            <div class="preview" id="imagePreview">
              <span class="hint">ตัวอย่างรูปจะแสดงที่นี่</span>
            </div>
            <div>
              <input type="file" id="image" name="image" accept="image/*" required />
              <div class="hint">รองรับไฟล์ภาพทั่วไป เช่น JPG, PNG, WEBP</div>
            </div>
          </div>
        </div>

        <div class="field">
          <div class="field-header">
            <label for="content">Content (field name: <code>content</code>)</label>
            <button type="button" class="settings-btn" id="promptToggle" title="แสดง/ซ่อน Prompt">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 20h9"></path>
                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
              </svg>
            </button>
          </div>
          <textarea id="content" name="content" placeholder="ใส่รายละเอียดหรือข้อความประกอบรูป" required></textarea>
        </div>

        <div class="field" id="promptField" style="display: none;">
          <label for="prompt">Prompt (field name: <code>prompt</code>) <span class="hint">(ไม่บังคับ)</span></label>
          <textarea id="prompt" name="prompt" placeholder="ใส่พรอมป์สำหรับระบบปลายทาง (ไม่ใส่ก็ได้)"></textarea>
        </div>

        <div class="field">
          <label for="scheduled_at">เวลาโพสต์ (field name: <code>scheduled_at</code>) <span class="hint">(ไม่บังคับ)</span></label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="post_timing" value="now" checked />
              <span>โพสต์ทันที</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="post_timing" value="scheduled" />
              <span>ตั้งเวลา</span>
            </label>
          </div>
          <input type="datetime-local" id="scheduled_at" name="scheduled_at" style="display: none;" />
          <div class="hint">เลือก "โพสต์ทันที" หรือ "ตั้งเวลา" ตามต้องการ</div>
        </div>

        <div class="actions">
          <span class="ghost" id="resultHint">ระบบจะส่งข้อมูลและเคลียร์ฟอร์มทันที</span>
          <button type="submit" class="primary" id="sendBtn">ส่ง</button>
        </div>

        <div class="status" id="statusMessage"></div>
      </form>
    </div>

    <!-- Loading Popup -->
    <div id="loadingPopup" class="loading-popup">
      <div class="loading-content">
        <div class="loading-spinner">
          <div class="spinner-ring"></div>
          <div class="spinner-ring"></div>
          <div class="spinner-ring"></div>
        </div>
        <div class="loading-text">กำลังส่งข้อมูลไปยัง Webhook<span class="loading-dots"></span></div>
        <div class="loading-subtext">กรุณารอสักครู่ ระบบกำลังประมวลผลข้อมูลของคุณ</div>
        <div class="loading-progress">
          <div class="progress-bar"></div>
        </div>
      </div>
    </div>

    <!-- Prompt Modal Popup -->
    <div id="promptModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Prompt Settings</h3>
          <button type="button" class="close-btn" id="closePromptModal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="field">
            <label for="prompt">Prompt (field name: <code>prompt</code>) <span class="hint">(ไม่บังคับ)</span></label>
            <textarea id="promptModal" placeholder="ใส่พรอมป์สำหรับระบบปลายทาง (ไม่ใส่ก็ได้)"></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="secondary" id="savePrompt">บันทึก</button>
          <button type="button" class="ghost" id="cancelPrompt">ยกเลิก</button>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
